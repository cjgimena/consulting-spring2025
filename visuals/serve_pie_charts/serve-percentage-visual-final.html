<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Donut Charts - Serve Stats</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background: #f5f5f5;
        }
    </style>
</head>

<body>
    <svg width="800" height="300"></svg>

    <script>
        d3.json("serve_pie_chart_sample.json").then(function (data) {
            const svg = d3.select("svg");
            const width = +svg.attr("width");
            const height = +svg.attr("height");
            const radius = 75;
            const boxWidth = 300;
            const boxHeight = 250;
            const padding = 50;

            const charts = [
                {
                    label: "First Serve",
                    data: data.serves.find(d => d.type === "First Serve"),
                    x: padding
                },
                {
                    label: "Second Serve",
                    data: data.serves.find(d => d.type === "Second Serve"),
                    x: boxWidth + padding * 2
                }
            ];

            charts.forEach((chart, i) => {
                const servePercentage = chart.data.in / chart.data.total;
                const servePointsWon = chart.data.won / chart.data.total;

                const group = svg.append("g")
                    .attr("transform", `translate(${chart.x + boxWidth / 2}, ${height / 2})`);

                svg.append("rect")
                    .attr("x", chart.x)
                    .attr("y", height / 2 - boxHeight / 2)
                    .attr("width", boxWidth)
                    .attr("height", boxHeight)
                    .attr("fill", "none")
                    .attr("stroke", "#444")
                    .attr("stroke-width", 2)
                    .attr("stroke-dasharray", "8,4");

                group.append("path")
                    .attr("d", d3.arc()
                        .innerRadius(radius)
                        .outerRadius(radius + 25)
                        .startAngle(0)
                        .endAngle(2 * Math.PI))
                    .attr("fill", "#ddd");

                group.append("path")
                    .attr("d", d3.arc()
                        .innerRadius(radius)
                        .outerRadius(radius + 25)
                        .startAngle(0)
                        .endAngle(2 * Math.PI * servePercentage)
                        .cornerRadius(20))
                    .attr("fill", "#2B5DA7");

                group.append("path")
                    .attr("d", d3.arc()
                        .innerRadius(radius)
                        .outerRadius(radius + 25)
                        .startAngle(0)
                        .endAngle(2 * Math.PI * servePointsWon)
                        .cornerRadius(20))
                    .attr("fill", "#E6A500");

                svg.append("text")
                    .attr("x", chart.x + boxWidth / 2)
                    .attr("y", height / 2 - boxHeight / 2 - 10)
                    .attr("text-anchor", "middle")
                    .attr("font-size", "16px")
                    .attr("fill", "#000")
                    .text(chart.label);
            });
        });
    </script>
</body>

</html>